<!DOCTYPE HTML>
<html>
<head>
<title>Листинг 7.16</title>
<!--Сценарий с функцией-->
<script>
//функция вызывается для создания нового документа:
function create(){
    //Переменная для записи ссылки на новое окно:
    let wnd = window.open()
    //В новом окне создается пустой документ:
    wnd.document.open()
    //Запись в документ инструкции, определяющей
    //тип созданного документа:
    wnd.document.writeln("<!DOCTYPE HTML>")
    //Запись начальных дескрипторов:
    wnd.document.writeln("<html>")
    wnd.document.writeln("<head><title></title></head>")
    //Вписываем дескриптор тела документа:
    wnd.document.writeln("<body>")
    //Добавляем блок заголовка:
    wnd.document.writeln("<h3>Новый документ</h3>")
    //Дописываем текстовый блок:
    wnd.document.writeln("<p>Этот документ создан с помощью сценария.</p>")
    //Дописываем текстовый блок в созданный документ:
    wnd.document.writeln("<p>Этот блок записан с помощью метода <code>writeln()</code>.</p>")
    //Создание нового элемента для текстового блока:
    let element = wnd.document.createElement("p")
    //Содержимое блока:
    element.innerHTML = "Этот блок создан с помощью метода <code>createElement()</code>."
    //Коллекция элементов для текстовых блоков
    //созданного документа:
    let plist = wnd.document.getElementsByTagName("p")
    //Вставка созданного блока перед
    //последним текстовым блоком:
    wnd.document.body.insertBefore(element,plist[plist.length-1])
    //Коллекция элементов для блоков сценария
    //исходного документа:
    let slist = document.getElementsByTagName("script")
    //Дописываем текстовый блок в созданный документ:
    wnd.document.writeln("<p>В исходном документе последний сценарий содержит команду:</p>")
    //Код последнего сценария из исходного документа:
    wnd.document.writeln("<code>"+slist[slist.length-1].innerHTML+"</code>")
    //Закрывающие дескрипторы:
    wnd.document.writeln("</body>")
    wnd.document.write("</html>")
    //Созданный документ закрывается для записи:
    wnd.document.close()
    //Считывание содержимого в текстовом поле
    //исходного документа:
   let txt = document.getElementById("myfield").value
    //Если поле пустое:
    if(txt == ""){
        txt = "Д777окумент без названия"
    }
    //Определяем название созданного документа:
    wnd.document.title = txt
}
</script>
</head>
<body><h3>Листинг 7.16</h3><hr/>
<h3>Программное создание документа</h3>
<p>Для создания нового документа следует щелкнуть кнопку. Название документа вводится
в текстовом поле. По умолчанию (если поле пустое) используется название <b> Документ без имени</b></p>
<!--Текстовое поле-->
<input id="myfield" type="text" size="50"/>
<!--Кнопка-->
<input type="button" value="Создать новый документ" onclick="create()"/>
<!--Линия-->
<hr/>
<!--Свойства документа-->
<h3>Некоторые свойства документа</h3>
<!--Кодировка-->
<p>В документе использована кодировка <b>
<script>
//Получение данных о кодировке документа:
document.write(document.characterSet)
</script>
</b></p>
<!--Размещение документа-->
<p>Размещение документа<b>
<script>
//Получение данных о размещении документа:
document.write(document.URL)
</script>
</b></p>
<!--Состояние загрузки документа-->
<p>Состояние документа<b>
<script>
//Определение статуса загрузки документа:
document.write(document.readyState)
</script>
</b></p>
<!--Линия-->
<hr/>
<!--Последний сценарий в документе-->
<script>document.write("Выполнен последний сценарий.")</script>
<br/>
<!--Текст-->
Документ загружен. Это последняя строка в документе.
</body>
</html>